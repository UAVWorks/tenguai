// ********************************************************************************************************************
// *                                                                                                                  *
// *                       The task. The agent which can calculate something using QJSEngine.                         *
// * ---------------------------------------------------------------------------------------------------------------- *
// *                    Задача. Агент, который может что-нибудь вычислять, используя QJSEngine.                       *
// *                                                                                                                  *
// * Eugene G. Sysoletin <e.g.sysoletin@gmail.com>                                       Created 09 jun 2017 at 09:57 *
// ********************************************************************************************************************

#include "Task.h"

// ********************************************************************************************************************
// *                                                                                                                  *
// *                                                    The constructor.                                              *
// * ---------------------------------------------------------------------------------------------------------------- *
// *                                                       Конструктор.                                               *
// *                                                                                                                  *
// ********************************************************************************************************************

tengu::Task::Task () 
    : SproutableAgent()
{
    _class_name = "Task";
    _entity_type = ET_Task;
}

// ********************************************************************************************************************
// *                                                                                                                  *
// *                                               Convert task to JSON object.                                       *
// * ---------------------------------------------------------------------------------------------------------------- *
// *                                            Преобразование задачи в объект JSON.                                  *
// *                                                                                                                  *
// ********************************************************************************************************************

QJsonObject tengu::Task::toJSON() {
    
    QJsonObject o = SproutableAgent::toJSON();
    
    o[ JSON_COLLECTION_ELEMENT ] = "tasks";
    
    o["start_condition"] = __start_condition;
    o["algorythm"] = __algorythm;
    o["stop_condition"] = __stop_condition;
    
    return o;
    
}

// ********************************************************************************************************************
// *                                                                                                                  * 
// *                                Convert JSON representation to object's data field values.                        *
// * ---------------------------------------------------------------------------------------------------------------- *
// *                                     Преобразование из JSONа в поля этого объекта.                                *
// *                                                                                                                  *
// ********************************************************************************************************************

bool tengu::Task::fromJSON(QJsonObject json) {
    
    bool result = SproutableAgent::fromJSON( json );
    if ( json.contains("start_condition") ) __start_condition = json.value("start_condition").toString();
    if ( json.contains("algorythm") ) __algorythm = json.value("algorythm").toString();
    if ( json.contains("stop_condition") ) __stop_condition = json.value("stop_condition").toString();
    
    return result;
    
}

// ********************************************************************************************************************
// *                                                                                                                  *
// *                                                  Return start condition                                          *
// * ---------------------------------------------------------------------------------------------------------------- *
// *                                               Вернуть условие старта задачи                                      *
// *                                                                                                                  *
// ********************************************************************************************************************

QString tengu::Task::startCondition() {

    return __start_condition;
}

// ********************************************************************************************************************
// *                                                                                                                  *
// *                                                   Set start condition.                                           *
// * ---------------------------------------------------------------------------------------------------------------- *
// *                                             Установить условие старта задачи.                                    *
// *                                                                                                                  *
// ********************************************************************************************************************

void tengu::Task::setStartCondition( QString start ) {

    __start_condition = start;
    _somethingChanged();
    
};

// ********************************************************************************************************************
// *                                                                                                                  *
// *                                                Return the task algorythm                                         *
// * ---------------------------------------------------------------------------------------------------------------- *
// *                                                  Вернуть алгоритм задачи.                                        *
// *                                                                                                                  *
// ********************************************************************************************************************

QString tengu::Task::algorythm() {

    return __algorythm;

};

// ********************************************************************************************************************
// *                                                                                                                  *
// *                                                  Set the task algorythm.                                         *
// * ---------------------------------------------------------------------------------------------------------------- *
// *                                            Установить алгоритм выполнения задачи.                                *
// *                                                                                                                  *
// ********************************************************************************************************************

void tengu::Task::setAlgorythm( QString alg ) {

    __algorythm = alg;
    _somethingChanged();
    
};

// ********************************************************************************************************************
// *                                                                                                                  *
// *                                               Return the stop task condition.                                    *
// * ---------------------------------------------------------------------------------------------------------------- *
// *                                              Вернуть условие остановки задачи.                                   *
// *                                                                                                                  *
// ********************************************************************************************************************

QString tengu::Task::stopCondition() {

    return __stop_condition;
    
};

// ********************************************************************************************************************
// *                                                                                                                  *
// *                                                Set the stop task condition.                                      *
// * ---------------------------------------------------------------------------------------------------------------- *
// *                                            Установить условие останова задачи.                                   *
// *                                                                                                                  *
// ********************************************************************************************************************

void tengu::Task::setStopCondition( QString stop ) {

    __stop_condition = stop;
    _somethingChanged();
}

// ********************************************************************************************************************
// *                                                                                                                  *
// *                                                     The destructor.                                              *
// * ---------------------------------------------------------------------------------------------------------------- *
// *                                                        Деструктор.                                               *
// *                                                                                                                  *
// ********************************************************************************************************************

tengu::Task::~Task() {

}


